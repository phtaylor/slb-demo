import{w as e,S as t,i as n,s,e as a,a as o,t as i,b as r,h as c,c as l,d as u,l as d,n as m,f as p,g as h,r as g,o as f,j as w,k as v,m as z,p as y,q as S,v as b}from"./main.js";import{a as M}from"./auth-b10b2639.js";const x=e("APP_DATA");function C(e){let t,n,s,h,g,f,w,v,z,y,S,b,M,x,C,R,A,T,V,k,$,D,L,E,P,U,X,B,G,N,j,F,H,I,O,Z,q,Y,_,J,K,Q,W,ee,te,ne,se,ae,oe,ie,re,ce,le,ue;return{c(){t=a("div"),n=a("div"),n.innerHTML='<img src="/images/logo-zea.svg" alt="logo"/>',s=o(),h=a("div"),g=a("zea-menu"),f=a("zea-menu-item"),w=i("View\n        "),v=a("zea-menu-subitems"),z=a("zea-menu-item"),y=i("Frame All"),S=o(),b=a("zea-menu-item"),M=i("Edit\n        "),x=a("zea-menu-subitems"),C=a("zea-menu-item"),R=a("zea-icon"),A=i("\n            Undo"),T=o(),V=a("zea-menu-item"),k=a("zea-icon"),$=i("\n            Redo"),D=o(),L=a("zea-menu-item"),E=a("zea-icon"),P=i("\n            Toggle Selection"),U=o(),X=a("zea-menu-item"),B=i("Collab\n        "),G=a("zea-menu-subitems"),N=a("zea-menu-item"),j=i("Direct Attention"),F=o(),H=a("zea-menu-item"),I=i("VR\n        "),O=a("zea-menu-subitems"),Z=a("zea-menu-item"),q=a("zea-icon"),Y=i("\n            Launch VR"),_=o(),J=a("zea-menu-item"),K=i("Spectator Mode"),Q=o(),W=a("div"),ee=a("zea-user-chip-set"),te=o(),ne=a("div"),se=a("zea-button"),se.textContent="Sign out",ae=o(),oe=a("div"),ie=o(),re=a("div"),ce=a("zea-user-chip"),r(n,"class","logo flex items-center h-full mr-4 svelte-1rtcwc3"),c(z,"class","menu-item svelte-1rtcwc3"),c(z,"hotkey","f"),c(z,"onclick",e[4]),c(R,"icon","arrow-undo"),c(R,"size","16"),c(C,"class","menu-item svelte-1rtcwc3"),c(C,"hotkey","ctrl+Z"),c(C,"onclick",e[5]),c(k,"icon","arrow-redo"),c(k,"size","16"),c(V,"class","menu-item svelte-1rtcwc3"),c(V,"hotkey","ctrl+Y"),c(V,"onclick",e[6]),c(E,"size","16"),c(L,"class","menu-item svelte-1rtcwc3"),c(L,"onclick",e[7]),c(N,"class","menu-item svelte-1rtcwc3"),c(N,"hotkey","ctrl+N"),c(N,"onclick",e[8]),c(q,"icon","recording-outline"),c(q,"size","16"),c(Z,"class","menu-item svelte-1rtcwc3"),c(Z,"onclick",e[9]),c(Z,"switch","true"),c(J,"switch","true"),c(J,"onclick",e[10]),c(g,"type","dropdown"),c(g,"show-anchor","true"),r(h,"class","flex-grow"),c(ee,"showimages",""),r(W,"class","panel-container mx-2 user-set-container svelte-1rtcwc3"),r(ne,"class","mr-2"),r(oe,"class","divider ml-2 svelte-1rtcwc3"),c(ce,"profile-card-align","right"),r(re,"class","user-container pl-2 svelte-1rtcwc3"),r(t,"class","flex items-center w-full h-full px-2")},m(a,o){l(a,t,o),u(t,n),u(t,s),u(t,h),u(h,g),u(g,f),u(f,w),u(f,v),u(v,z),u(z,y),u(g,S),u(g,b),u(b,M),u(b,x),u(x,C),u(C,R),u(C,A),u(x,T),u(x,V),u(V,k),u(V,$),u(x,D),u(x,L),u(L,E),u(L,P),u(g,U),u(g,X),u(X,B),u(X,G),u(G,N),u(N,j),u(g,F),u(g,H),u(H,I),u(H,O),u(O,Z),u(Z,q),u(Z,Y),e[12](Z),u(O,_),u(O,J),u(J,K),e[13](J),u(t,Q),u(t,W),u(W,ee),e[14](ee),u(t,te),u(t,ne),u(ne,se),u(t,ae),u(t,oe),u(t,ie),u(t,re),u(re,ce),e[15](ce),le||(ue=d(se,"click",e[11]),le=!0)},p:m,i:m,o:m,d(n){n&&p(t),e[12](null),e[13](null),e[14](null),e[15](null),le=!1,ue()}}}function R(e,t,n){let s,a,o,i,r,c;h(e,x,(e=>n(17,s=e))),h(e,g,(e=>n(18,a=e))),f((()=>{n(2,r.textContent="VR Device Not Detected",r),n(2,r.disabled=!0,r),M.getUserData().then((e=>{if(!e)return;{const{renderer:e}=s;e.getXRViewport().then((e=>{e.spectatorMode=!1,r&&n(2,r.textContent="Launch VR",r),e.on("presentingChanged",(e=>{const{state:t}=e;n(2,r.textContent=t?"Exit VR":"Launch VR",r)}))})).catch((e=>{console.warn("Unable to setup XR:"+e)}))}const{renderer:t,session:a,sessionSync:c}=s;n(1,i.userData=e,i),n(0,o.session=a,o),window.addEventListener("zeaUserClicked",(e=>{const n=c.userDatas[e.detail.id];if(n){const e=n.avatar,s=e.viewXfo,a=e.focalDistance||1,o=s.tr.add(s.ori.getZaxis().scale(-a)),i=t.getViewport();i.getManipulator().orientPointOfView(i.getCamera(),s.tr,o,1,1e3)}}))}))}));let l=!1;return[o,i,r,c,function(){const{renderer:e}=s;e.frameAll()},function(){const{undoRedoManager:e}=s;e.undo()},function(){const{undoRedoManager:e}=s;e.redo()},function(){const{toolManager:e}=s;l?(e.popTool(),l=!1):(e.pushTool("SelectionTool"),l=!0)},function(){M.getUserData().then((e=>{if(!e)return;const{renderer:t,sessionSync:n}=s;{const e=t.getViewport().getCamera(),s=e.getParameter("GlobalXfo").getValue(),a=e.getTargetPosition();n.directAttention(s.tr,a,1,1e3)}}))},function(){const{renderer:e}=s;e.getXRViewport().then((e=>{e.togglePresenting()})).catch((e=>{console.warn("Unable to setup XR:"+e)}))},function(){const{renderer:e}=s;e.getXRViewport().then((e=>{e.spectatorMode=!e.spectatorMode}))},async()=>{await M.signOut(),a("/login")},function(e){w[e?"unshift":"push"]((()=>{r=e,n(2,r)}))},function(e){w[e?"unshift":"push"]((()=>{c=e,n(3,c)}))},function(e){w[e?"unshift":"push"]((()=>{o=e,n(0,o)}))},function(e){w[e?"unshift":"push"]((()=>{i=e,n(1,i)}))}]}class A extends t{constructor(e){super(),n(this,e,R,C,s,{})}}class T extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"open"});this.div=document.createElement("div"),this.div.classList.add("fps-display"),e.appendChild(this.div);const t=document.createElement("style");t.appendChild(document.createTextNode("\n      .fps-display {\n        position: fixed;\n        bottom: 10px;\n        right: 10px;\n        color: #000000;\n      }\n    ")),e.appendChild(t)}set renderer(e){let t=0,n=0;e.on("redrawOccurred",(()=>{t++})),setInterval((()=>{n!=2*t&&(n=2*t,this.div.textContent=`Fps: ${n}`),t=0}),500)}}function V(e){let t,n,s,i,d,h,g,f;return{c(){t=a("zea-layout"),n=a("div"),s=a("canvas"),i=o(),d=a("div"),h=a("zea-progress-bar"),g=o(),f=a("div"),r(s,"id","renderer"),r(s,"class","svelte-yd7tef"),r(d,"class","relative"),r(n,"slot","B"),r(n,"class","h-full w-full"),c(t,"add-cells","AB"),c(t,"borders",""),c(t,"cell-a-size","2"),c(t,"show-resize-handles","A")},m(a,o){l(a,t,o),u(t,n),u(n,s),e[3](s),u(n,i),u(n,d),u(d,h),e[4](h),u(n,g),u(n,f),e[5](f)},p:m,i:m,o:m,d(n){n&&p(t),e[3](null),e[4](null),e[5](null)}}}function k(e,t,n){const{Color:s,GLRenderer:a,Scene:o,resourceLoader:i,SystemDesc:r,EnvMap:c}=window.zeaEngine,{SelectionManager:l,UndoRedoManager:u,ToolManager:d,SelectionTool:m}=window.zeaUx,{Session:p,SessionSync:h}=window.zeaCollab;let g,v,z,y;return f((()=>{const e=new a(g),t=new o;t.setupGrid(10,10),e.setScene(t);const s={};s.renderer=e,s.scene=t,z=[t.getRoot()];const r=u.getInstance();s.undoRedoManager=r;const c=e.getViewport().getManipulator(),f=new d(s),w=new l(s);w.showHandles(),s.selectionManager=w;const S=new m(s);if(f.registerTool("SelectionTool",S),f.registerTool("CameraManipulator",c),e.getViewport().setManipulator(f),f.pushTool("CameraManipulator"),s.toolManager=f,y){n(2,y.percent=0,y),n(2,y.style.visibility="hidden",y);let e=!1,t=0;i.on("progressIncremented",(s=>{if(y){e?t>0&&clearTimeout(t):(n(2,y.style.visibility="visible",y),e=!0);const{percent:a}=s;n(2,y.percent=a,y),a>=100&&(t=setTimeout((()=>{n(2,y.style.visibility="hidden",y),t=0,e=!1}),1e3))}}))}{const t=document.createElement("fps-display");t.renderer=e,v.appendChild(t)}M.getUserData().then((e=>{if(!e)return;const t=new p(e,"https://websocket-staging.zea.live");t.joinRoom("zea-template-collab");const n=new h(t,s,e,{});s.userData=e,s.session=t,s.sessionSync=n,x.set(s)}));const{GLCADPass:b,CADAsset:C}=window.zeaCad;let R="/assets/Fidget-Spinner-2.zcad";const A=new URLSearchParams(location.search);if(A.has("file")){const e=A.get("file");R=`https://storage.googleapis.com/visualive-tmp/SLB/${e}/${e}.zcad`}e.addPass(new b);const T=new C;T.on("loaded",(()=>{T.getMaterialLibrary().getMaterials().forEach((e=>{"SimpleSurfaceShader"==e.getShaderName()&&e.setShaderName("StandardSurfaceShader")})),e.frameAll()})),T.getGeometryLibrary().on("loaded",(()=>{e.frameAll()})),t.getRoot().addChild(T),T.getParameter("FilePath").setValue(R),x.set(s)})),[g,v,y,function(e){w[e?"unshift":"push"]((()=>{g=e,n(0,g)}))},function(e){w[e?"unshift":"push"]((()=>{y=e,n(2,y)}))},function(e){w[e?"unshift":"push"]((()=>{v=e,n(1,v)}))}]}customElements.define("fps-display",T);class $ extends t{constructor(e){super(),n(this,e,k,V,s,{})}}function D(e){let t,n,s,i,d,h,g;return s=new A({}),h=new $({}),{c(){t=a("zea-layout"),n=a("div"),v(s.$$.fragment),i=o(),d=a("div"),v(h.$$.fragment),r(n,"slot","A"),r(n,"class","h-full w-full"),r(d,"slot","B"),r(d,"class","h-full w-full"),c(t,"orientation","vertical"),c(t,"cell-a-size","50"),c(t,"add-cells","AB"),c(t,"borders","")},m(e,a){l(e,t,a),u(t,n),z(s,n,null),u(t,i),u(t,d),z(h,d,null),g=!0},p:m,i(e){g||(y(s.$$.fragment,e),y(h.$$.fragment,e),g=!0)},o(e){S(s.$$.fragment,e),S(h.$$.fragment,e),g=!1},d(e){e&&p(t),b(s),b(h)}}}function L(e,t,n){let s;return h(e,g,(e=>n(0,s=e))),f((async()=>{await M.isAuthenticated()||s("/login")})),[]}export default class extends t{constructor(e){super(),n(this,e,L,D,s,{})}}
//# sourceMappingURL=index-beed2c4f.js.map
